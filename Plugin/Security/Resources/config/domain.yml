services:

    _defaults:
        autowire: true
        autoconfigure: true
        bind:
            $redisClient: "@apisearch_plugin.security.redis_client"

    Apisearch\Plugin\Security\Domain\:
        resource: '../../Domain/'

    #
    # Token Validators
    #
    apisearch_plugin.security.http_referrers_token_validator:
        class: Apisearch\Plugin\Security\Domain\Token\HttpReferrersTokenValidator
        tags: ["apisearch_server.token_validator"]

    apisearch_plugin.security.seconds_valid_token_validator:
        class: Apisearch\Plugin\Security\Domain\Token\SecondsValidTokenValidator
        tags: ["apisearch_server.token_validator"]

    apisearch_plugin.security.requests_limit_token_validator:
        class: Apisearch\Plugin\Security\Domain\Token\RequestsLimitTokenValidator
        tags: ["apisearch_server.token_validator"]

    #
    # Middleware
    #
    ap√¨search_plugin.security.restricted_fields_middleware:
        class: Apisearch\Plugin\Security\Domain\Middleware\RestrictedFieldsMiddleware
        tags: ["apisearch_plugin.middleware"]